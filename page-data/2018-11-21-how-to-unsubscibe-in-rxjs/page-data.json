{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/2018-11-21-how-to-unsubscibe-in-rxjs/",
    "result": {"data":{"site":{"siteMetadata":{"title":"YH.K Logs"}},"markdownRemark":{"id":"bce0368b-3182-5787-ad16-1311e78066f1","excerpt":"Angular는 기본적으로 RxJS를 사용합니다. RxJS를 사용할때 스트림을 연 컴포넌트가 없어진다 해도 열린 스트림은 닫히지 않기 때문에 메모리를 계속 먹습니다. 그렇기 때문에 Unsubscribe를 호출하여 스트림을 닫아주어야하는데요. 매번 Unsubscribe…","html":"<p><strong>Angular</strong>는 기본적으로 <strong>RxJS</strong>를 사용합니다. <strong>RxJS</strong>를 사용할때 스트림을 연 컴포넌트가 없어진다 해도 열린 스트림은 닫히지 않기 때문에 메모리를 계속 먹습니다. 그렇기 때문에 <strong>Unsubscribe</strong>를 호출하여 스트림을 닫아주어야하는데요. 매번 <strong>Unsubscribe</strong>를 하기는 너무나 귀찮음으로 스트림 구독을 해제할 수 있는 다양한 방법을 소개합니다.\n참고로 <strong>HttpClient</strong>, <strong>Router</strong> 등 앵귤러 내부에서 제공하는 기능들은 따로 <strong>Unsubscribe</strong>를 하지 않아도 자동으로 구독을 해제합니다.</p>\n<!-- more -->\n<h2>Async Pipe</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescriptsome-component.ts\"><pre class=\"language-typescriptsome-component.ts\"><code class=\"language-typescriptsome-component.ts\">export class SomeComponent implements OnInit {\n\tlist$: Observable&lt;Item[]&gt;;\n\tngOnInit(): void {\n\t    this.list$ = this.api.getList();\n\t}\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"htmlsome-component.html\"><pre class=\"language-htmlsome-component.html\"><code class=\"language-htmlsome-component.html\">&lt;ng-container *ngIf=&quot;list$ | async as list; else loadingTemplate&quot;&gt;\n    &lt;app-table [list]=&quot;list&quot; [keys]=&quot;keys&quot;&gt;&lt;/app-table&gt;\n&lt;/ng-container&gt;</code></pre></div>\n<p><strong>Angular</strong> 에서 제공하는 <strong>Async</strong> pipe를 사용하는 방법입니다.\n<strong>Async</strong> pipe가 알아서 Observable을 구독하고 해지하기 때문에 사용자는 별도로 신경써줄 필요가 없죠. 다만 이 방법은 두가지의 문제가 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescriptsome-component.ts\"><pre class=\"language-typescriptsome-component.ts\"><code class=\"language-typescriptsome-component.ts\">export class SomeComponent implements OnInit {\n\tlist$: Observable&lt;Item[]&gt;;\n\tngOnInit(): void {\n\t\tthis.list$ = this.api.getList().pipe(\n\t\t\ttap(list =&gt; console.log(list))\n\t\t);\n\t}\n}</code></pre></div>\n<p>첫번째로 스크립트내에서 데이터를 쓰기가 귀찮습니다. html에서 event를 통해서 받거나, 아니면 tap operator를 이용해 후킹하여 데이터를 저장해야합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"htmlsome-component.html\"><pre class=\"language-htmlsome-component.html\"><code class=\"language-htmlsome-component.html\">&lt;section&gt;\n\t&lt;ng-container *ngIf=&quot;list$ | async as list; else loadingTemplate&quot;&gt;\n\t    &lt;app-table [list]=&quot;list&quot; [keys]=&quot;keys&quot;&gt;&lt;/app-table&gt;\n\t&lt;/ng-container&gt;\n&lt;/section&gt;\n&lt;footer class=&quot;another&quot;&gt;\n\t&lt;!-- Error --&gt;\n\t&lt;pre [innerHTML]=&quot;list | json&quot;&gt;&lt;/pre&gt;\n&lt;/footer&gt;</code></pre></div>\n<p>list를 선언한 안쪽이 아닌 바깥쪽에서는 list에 접근할 수가 없습니다.\nasync pipe를 여러번 사용하면 api 요청도 여러번 날라가기 때문에 미리 마크업 구조를 잡고 가야합니다.</p>\n<h2>TakeUntill</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescriptsome-component.ts\"><pre class=\"language-typescriptsome-component.ts\"><code class=\"language-typescriptsome-component.ts\">export class SomeComponent implements OnInit, OnDestroy {\n\tlist: Item[];\n\tlist$: Observable&lt;Item[]&gt;;\n\tprivate unsubscribe$ = new Subject();\n\tngOnInit(): void {\n\t\tthis.list$ = this.api.getList().pipe(\n\t\t\ttakeUntill(this.unsubscribe$)\n\t\t).subscribe(list =&gt; {\n\t\t\tthis.list = list;\n\t\t});\n\t}\n\tngOnDestroy(): void {\n\t    this.unsubscribe$.next();\n\t    this.unsubscribe$.complete();\n\t}\n}</code></pre></div>\n<p>인자로 넣어준 Observable (Subject)가 값을 방출하거나 종료할 경우 구독을 해제합니다.</p>\n<h2>TakeWhile</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescriptsome-component.ts\"><pre class=\"language-typescriptsome-component.ts\"><code class=\"language-typescriptsome-component.ts\">export class SomeComponent implements OnInit, OnDestroy {\n\tlist: Item[];\n\tlist$: Observable&lt;Item[]&gt;;\n\tprivate subscribing = true;\n\tngOnInit(): void {\n\t\tthis.list$ = this.api.getList().pipe(\n\t\t\ttakeWhile(this.subscribing)\n\t\t).subscribe(list =&gt; {\n\t\t\tthis.list = list;\n\t\t});\n\t}\n\tngOnDestroy(): void {\n\t    this.subscribing = false;\n\t}\n}</code></pre></div>\n<p>인자로 넣어준 Boolean 값이 false일 경우 구독이 일어나지 않습니다.</p>\n<h2>Take</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescriptsome-component.ts\"><pre class=\"language-typescriptsome-component.ts\"><code class=\"language-typescriptsome-component.ts\">export class SomeComponent implements OnInit {\n\tlist: Item[];\n\tlist$: Observable&lt;Item[]&gt;;\n\n\tngOnInit(): void {\n\t\tthis.list$ = this.api.getList().pipe(\n\t\t\ttake(1)\n\t\t).subscribe(list =&gt; {\n\t\t\tthis.list = list;\n\t\t});\n\t}\n}</code></pre></div>\n<p>인자로 넣어준 숫자만큼 <strong>publish</strong>가 일어나면 구독을 종료합니다.</p>\n<h2>First</h2>\n<div class=\"gatsby-highlight\" data-language=\"typescriptsome-component.ts\"><pre class=\"language-typescriptsome-component.ts\"><code class=\"language-typescriptsome-component.ts\">export class SomeComponent implements OnInit {\n\tlist: Item[];\n\tlist$: Observable&lt;Item[]&gt;;\n\n\tngOnInit(): void {\n\t\tthis.list$ = this.api.getList().pipe(\n\t\t\tfirst()\n\t\t).subscribe(list =&gt; {\n\t\t\tthis.list = list;\n\t\t});\n\t}\n}</code></pre></div>\n<p>첫번째 구독만 받는 operator입니다.\n인자로 expression을 넘겨줄 수 있습니다.</p>\n<p>이 밖에도 효율적인 <strong>Unsubscribe</strong> 방법이 있다면 알려주세요 !!</p>\n<!--stackedit_data:\neyJoaXN0b3J5IjpbLTYxOTU5MjM0MywxNjEwNTEzMzc5XX0=\n-->","frontmatter":{"title":"Rxjs 구독을 취소하는 여러가지 방법","date":"November 21, 2018","description":null}},"previous":{"fields":{"slug":"/2018-11-17-hexo-travis-stackedit/"},"frontmatter":{"title":"블로깅을 편하게 하기 위한 발악 (hexo, travis, stackedit)"}},"next":{"fields":{"slug":"/2018-12-11-hexo-clipboard/"},"frontmatter":{"title":"Hexo에서 Code Copy (Clipboard) 버튼 만들기"}}},"pageContext":{"id":"bce0368b-3182-5787-ad16-1311e78066f1","previousPostId":"11936248-4fef-5537-a7ea-d8e77a62a5e9","nextPostId":"30191b74-7685-58f2-a7a1-ddeeb10ed1c4"}},
    "staticQueryHashes": ["230163734","2841359383"]}